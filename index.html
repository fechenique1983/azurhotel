<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#17355B">
    <title>Azur Hotel & Spa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'azur-blue': '#17355B',
                        'azur-cream': '#EFEEE8',
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #EFEEE8;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <script>
        const { useState, useEffect, useRef } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyB_LypCFg7wGvAL_1lmXoErtizYbn7e6Jw",
            authDomain: "azurhotel-2bfc2.firebaseapp.com",
            databaseURL: "https://azurhotel-2bfc2-default-rtdb.firebaseio.com",
            projectId: "azurhotel-2bfc2",
            storageBucket: "azurhotel-2bfc2.appspot.com",
            messagingSenderId: "1044293260996",
            appId: "1:1044293260996:web:9048cbe9a0b944b99b1b91"
        };

        let db = null;
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            db = firebase.database();
            console.log("âœ… Firebase conectado");
        } catch (error) {
            console.error("âŒ Error Firebase:", error);
        }

        // Iconos SVG simples
        const BellIcon = () => React.createElement('svg', { className: 'w-5 h-5', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9' })
        );

        const ChatIcon = () => React.createElement('svg', { className: 'w-5 h-5', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z' })
        );

        const SendIcon = () => React.createElement('svg', { className: 'w-5 h-5', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M12 19l9 2-9-18-9 18 9-2zm0 0v-8' })
        );

        const ImageIconSVG = () => React.createElement('svg', { className: 'w-5 h-5', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z' })
        );

        const XIcon = () => React.createElement('svg', { className: 'w-6 h-6', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M6 18L18 6M6 6l12 12' })
        );

        function AzurHotelApp() {
            const [user, setUser] = useState(null);
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [rooms, setRooms] = useState([]);
            const [selectedRoom, setSelectedRoom] = useState(null);
            const [statusHistory, setStatusHistory] = useState([]);
            
            // Chat y notificaciones
            const [showChat, setShowChat] = useState(false);
            const [showNotifications, setShowNotifications] = useState(false);
            const [messages, setMessages] = useState([]);
            const [notifications, setNotifications] = useState([]);
            const [newMessage, setNewMessage] = useState('');
            const [selectedGroup, setSelectedGroup] = useState('general');
            const [messagePriority, setMessagePriority] = useState('normal');
            const [selectedImage, setSelectedImage] = useState(null);
            const fileInputRef = useRef(null);

            const users = [
                { id: 1, username: 'fechenique', password: 'azur2024', name: 'Federico Echenique', role: 'Gerencia', canEdit: true, allowedStatuses: ['all'] },
                { id: 2, username: 'recepcion', password: 'recep123', name: 'RecepciÃ³n', role: 'RecepciÃ³n', canEdit: true, allowedStatuses: ['all'] },
                { id: 3, username: 'reservas', password: 'recep123', name: 'Reservas', role: 'RecepciÃ³n', canEdit: true, allowedStatuses: ['all'] },
                { id: 4, username: 'bheredia', password: 'limpia123', name: 'Blanca Heredia', role: 'Housekeeping', canEdit: true, allowedStatuses: ['Limpia', 'En Limpieza', 'Sucia'] },
                { id: 5, username: 'narguello', password: 'limpia123', name: 'Natalia Arguello', role: 'Housekeeping', canEdit: true, allowedStatuses: ['Limpia', 'En Limpieza', 'Sucia'] },
                { id: 6, username: 'vpastori', password: 'limpia123', name: 'Victoria Pastori', role: 'Housekeeping', canEdit: true, allowedStatuses: ['Limpia', 'En Limpieza', 'Sucia'] },
                { id: 7, username: 'fguzman', password: 'limpia123', name: 'Florencia Guzman', role: 'Housekeeping', canEdit: true, allowedStatuses: ['Limpia', 'En Limpieza', 'Sucia'] },
                { id: 8, username: 'mabregu', password: 'mant123', name: 'Marcelo Abregu', role: 'Mantenimiento', canEdit: true, allowedStatuses: ['En Control Mantenimiento', 'Sucia'] },
                { id: 9, username: 'jacosta', password: 'mant123', name: 'Javier Acosta', role: 'Mantenimiento', canEdit: true, allowedStatuses: ['En Control Mantenimiento', 'Sucia'] },
                { id: 10, username: 'cbustamante', password: 'mant123', name: 'Cristian Bustamante', role: 'Mantenimiento', canEdit: true, allowedStatuses: ['En Control Mantenimiento', 'Sucia'] },
                { id: 11, username: 'pastor', password: 'mant123', name: 'Pastor', role: 'Mantenimiento', canEdit: true, allowedStatuses: ['En Control Mantenimiento', 'Sucia'] },
                { id: 12, username: 'spa', password: 'spa123', name: 'Spa', role: 'Spa', canEdit: false, allowedStatuses: [] },
                { id: 13, username: 'despensa', password: 'rest123', name: 'Despensa', role: 'Restaurant', canEdit: false, allowedStatuses: [] }
            ];

            const statusOptions = [
                { value: 'Limpia', color: 'bg-green-500' },
                { value: 'Sucia', color: 'bg-red-500' },
                { value: 'En Limpieza', color: 'bg-yellow-500' },
                { value: 'En Control Mantenimiento', color: 'bg-orange-500' },
                { value: 'Bloqueada', color: 'bg-gray-500' }
            ];

            useEffect(() => {
                const initialRooms = [
                    { id: 1, number: '1', category: 'Standard', floor: 'Primer Piso - Lobby', status: 'Limpia' },
                    { id: 2, number: '2', category: 'ClÃ¡sica', floor: 'Primer Piso - Lobby', status: 'Limpia' },
                    { id: 3, number: '3', category: 'ClÃ¡sica', floor: 'Primer Piso - Lobby', status: 'Sucia' },
                    { id: 4, number: '4', category: 'Standard', floor: 'Primer Piso - Lobby', status: 'Limpia' },
                    { id: 5, number: '5', category: 'ClÃ¡sica', floor: 'Primer Piso - Lobby', status: 'Limpia' },
                    { id: 6, number: '6', category: 'ClÃ¡sica', floor: 'Primer Piso - Lobby', status: 'Sucia' },
                    { id: 7, number: '7', category: 'ClÃ¡sica', floor: 'Primer Piso - Lobby', status: 'Limpia' },
                    { id: 8, number: '8', category: 'Superior', floor: 'Primer Piso - Patio', status: 'Limpia' },
                    { id: 9, number: '9', category: 'Superior', floor: 'Primer Piso - Patio', status: 'Sucia' },
                    { id: 10, number: '10', category: 'Standard', floor: 'Primer Piso - Patio', status: 'Limpia' },
                    { id: 11, number: '11', category: 'Deluxe', floor: 'Primer Piso - Patio', status: 'Limpia' },
                    { id: 18, number: '18', category: 'Suite Azur', floor: 'Primer Piso - Patio', status: 'Limpia' },
                    { id: 12, number: '12', category: 'Superior', floor: 'Tercer Piso', status: 'Limpia' },
                    { id: 14, number: '14', category: 'Deluxe', floor: 'Tercer Piso', status: 'Sucia' },
                    { id: 15, number: '15', category: 'ClÃ¡sica', floor: 'Tercer Piso - Terraza', status: 'Limpia' },
                    { id: 16, number: '16', category: 'Dpto Deluxe', floor: 'Tercer Piso - Terraza', status: 'Limpia' }
                ];

                if (db) {
                    const roomsRef = db.ref('rooms');
                    roomsRef.once('value', (snapshot) => {
                        const data = snapshot.val();
                        if (!data || Object.keys(data).length === 0) {
                            initialRooms.forEach(room => {
                                roomsRef.child(room.id.toString()).set(room);
                            });
                        }
                    });

                    roomsRef.on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            setRooms(Object.values(data));
                        }
                    });

                    const historyRef = db.ref('statusHistory');
                    historyRef.limitToLast(50).on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            setStatusHistory(Object.values(data));
                        }
                    });

                    const messagesRef = db.ref('messages');
                    messagesRef.limitToLast(50).on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            setMessages(Object.values(data).sort((a, b) => a.timestamp - b.timestamp));
                        }
                    });

                    const notificationsRef = db.ref('notifications');
                    notificationsRef.limitToLast(50).on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            setNotifications(Object.values(data).sort((a, b) => b.timestamp - a.timestamp));
                        }
                    });

                    return () => {
                        roomsRef.off();
                        historyRef.off();
                        messagesRef.off();
                        notificationsRef.off();
                    };
                } else {
                    setRooms(initialRooms);
                }
            }, []);

            const handleLogin = (e) => {
                e.preventDefault();
                const foundUser = users.find(u => u.username === username && u.password === password);
                if (foundUser) {
                    setUser(foundUser);
                    setError('');
                } else {
                    setError('Usuario o contraseÃ±a incorrectos');
                }
            };

            const handleStatusChange = (roomId, newStatus) => {
                if (!user.canEdit) return;
                if (user.allowedStatuses[0] !== 'all' && !user.allowedStatuses.includes(newStatus)) {
                    return;
                }

                const room = rooms.find(r => r.id === roomId);
                const now = Date.now();

                const historyEntry = {
                    roomId,
                    roomNumber: room.number,
                    previousStatus: room.status,
                    newStatus,
                    changedBy: user.name,
                    changedAt: now
                };

                if (db) {
                    db.ref('rooms/' + roomId).update({
                        status: newStatus,
                        lastUpdated: now,
                        updatedBy: user.name
                    });
                    db.ref('statusHistory').push(historyEntry);
                    
                    // Crear notificaciÃ³n
                    const priority = (newStatus === 'Bloqueada' || newStatus === 'En Control Mantenimiento') ? 'urgente' : 'normal';
                    db.ref('notifications').push({
                        type: 'status',
                        roomNumber: room.number,
                        oldStatus: room.status,
                        newStatus,
                        changedBy: user.name,
                        timestamp: now,
                        priority,
                        read: false
                    });
                }

                setSelectedRoom(null);
            };

            const sendMessage = () => {
                if (!newMessage.trim() && !selectedImage) return;
                
                const message = {
                    sender: user.name,
                    senderRole: user.role,
                    text: newMessage,
                    image: selectedImage,
                    timestamp: Date.now(),
                    group: selectedGroup,
                    priority: messagePriority
                };
                
                if (db) {
                    db.ref('messages').push(message);
                    
                    // Crear notificaciÃ³n de mensaje
                    db.ref('notifications').push({
                        type: 'message',
                        sender: user.name,
                        text: newMessage.substring(0, 50) + (newMessage.length > 50 ? '...' : ''),
                        hasImage: !!selectedImage,
                        timestamp: Date.now(),
                        group: selectedGroup,
                        priority: messagePriority,
                        read: false
                    });
                }
                
                setNewMessage('');
                setSelectedImage(null);
                setMessagePriority('normal');
            };

            const handleImageSelect = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setSelectedImage(reader.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const markAllAsRead = () => {
                if (db) {
                    notifications.forEach(notif => {
                        const notifRef = db.ref('notifications');
                        notifRef.orderByChild('timestamp').equalTo(notif.timestamp).once('value', (snapshot) => {
                            snapshot.forEach((childSnapshot) => {
                                childSnapshot.ref.update({ read: true });
                            });
                        });
                    });
                }
            };

            const getAvailableGroups = () => {
                const groups = [
                    { id: 'general', name: 'General', description: 'Todos' }
                ];
                
                if (user.role === 'RecepciÃ³n' || user.role === 'Housekeeping') {
                    groups.push({ id: 'recepcion-housekeeping', name: 'RecepciÃ³n + Housekeeping', description: 'Limpieza' });
                }
                if (user.role === 'RecepciÃ³n' || user.role === 'Mantenimiento') {
                    groups.push({ id: 'recepcion-mantenimiento', name: 'RecepciÃ³n + Mantenimiento', description: 'Mantenimiento' });
                }
                if (user.role === 'Gerencia' || user.role === 'Housekeeping') {
                    groups.push({ id: 'gerencia-housekeeping', name: 'Gerencia + Housekeeping', description: 'SupervisiÃ³n' });
                }
                if (user.role === 'Gerencia' || user.role === 'RecepciÃ³n') {
                    groups.push({ id: 'gerencia-recepcion', name: 'Gerencia + RecepciÃ³n', description: 'CoordinaciÃ³n' });
                }
                
                return groups;
            };

            const canAccessGroup = (groupId) => {
                if (groupId === 'general') return true;
                if (groupId === 'recepcion-housekeeping') return user.role === 'RecepciÃ³n' || user.role === 'Housekeeping';
                if (groupId === 'recepcion-mantenimiento') return user.role === 'RecepciÃ³n' || user.role === 'Mantenimiento';
                if (groupId === 'gerencia-housekeeping') return user.role === 'Gerencia' || user.role === 'Housekeeping';
                if (groupId === 'gerencia-recepcion') return user.role === 'Gerencia' || user.role === 'RecepciÃ³n';
                return false;
            };

            const getFilteredMessages = () => {
                return messages.filter(msg => msg.group === selectedGroup && canAccessGroup(msg.group));
            };

            const canChangeToStatus = (status) => {
                if (!user.canEdit) return false;
                if (user.allowedStatuses[0] === 'all') return true;
                return user.allowedStatuses.includes(status);
            };

            const getStatusColor = (status) => {
                const opt = statusOptions.find(s => s.value === status);
                return opt?.color || 'bg-gray-500';
            };

            const groupByFloor = () => {
                const floors = {};
                rooms.forEach(room => {
                    if (!floors[room.floor]) floors[room.floor] = [];
                    floors[room.floor].push(room);
                });
                return floors;
            };

            const formatTime = (timestamp) => {
                const date = new Date(timestamp);
                return date.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
            };

            const getPriorityBadge = (priority) => {
                if (priority === 'urgente') return 'bg-red-500';
                if (priority === 'normal') return 'bg-yellow-500';
                return 'bg-blue-500';
            };

            const unreadNotifications = notifications.filter(n => !n.read).length;

            if (!user) {
                return React.createElement('div', {
                    className: 'min-h-screen flex items-center justify-center p-4',
                    style: { background: 'linear-gradient(135deg, #17355B 0%, #2563eb 100%)' }
                },
                    React.createElement('div', { className: 'bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full' },
                        React.createElement('div', { className: 'text-center mb-8' },
                            React.createElement('h1', { 
                                className: 'text-3xl font-bold mb-2',
                                style: { color: '#17355B' }
                            }, 'Azur Hotel & Spa'),
                            React.createElement('p', { className: 'text-gray-600' }, 'Sistema de GestiÃ³n Operativa')
                        ),
                        React.createElement('form', { onSubmit: handleLogin, className: 'space-y-4' },
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'Usuario'),
                                React.createElement('input', {
                                    type: 'text',
                                    value: username,
                                    onChange: (e) => setUsername(e.target.value),
                                    className: 'w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2',
                                    placeholder: 'Ingresa tu usuario',
                                    required: true
                                })
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'ContraseÃ±a'),
                                React.createElement('input', {
                                    type: 'password',
                                    value: password,
                                    onChange: (e) => setPassword(e.target.value),
                                    className: 'w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2',
                                    placeholder: 'Ingresa tu contraseÃ±a',
                                    required: true
                                })
                            ),
                            error && React.createElement('div', { 
                                className: 'bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm' 
                            }, error),
                            React.createElement('button', {
                                type: 'submit',
                                className: 'w-full text-white py-3 rounded-lg font-semibold hover:opacity-90 transition',
                                style: { backgroundColor: '#17355B' }
                            }, 'Iniciar SesiÃ³n')
                        )
                    )
                );
            }

            const roomsByFloor = groupByFloor();

            return React.createElement('div', { 
                className: 'min-h-screen',
                style: { backgroundColor: '#EFEEE8' }
            },
                // Header
                React.createElement('div', { 
                    className: 'text-white shadow-lg',
                    style: { backgroundColor: '#17355B' }
                },
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-4' },
                        React.createElement('div', { className: 'flex justify-between items-center' },
                            React.createElement('div', null,
                                React.createElement('h1', { className: 'text-xl font-bold' }, 'Azur Hotel & Spa'),
                                React.createElement('p', { className: 'text-sm opacity-90' }, user.name + ' - ' + user.role)
                            ),
                            React.createElement('div', { className: 'flex items-center space-x-3' },
                                React.createElement('button', {
                                    onClick: () => { setShowNotifications(!showNotifications); setShowChat(false); },
                                    className: 'relative bg-white bg-opacity-20 px-4 py-2 rounded-lg hover:bg-opacity-30 transition flex items-center'
                                },
                                    React.createElement(BellIcon),
                                    unreadNotifications > 0 && React.createElement('span', { 
                                        className: 'absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold' 
                                    }, unreadNotifications)
                                ),
                                React.createElement('button', {
                                    onClick: () => { setShowChat(!showChat); setShowNotifications(false); },
                                    className: 'bg-white bg-opacity-20 px-4 py-2 rounded-lg hover:bg-opacity-30 transition flex items-center'
                                },
                                    React.createElement(ChatIcon),
                                    React.createElement('span', { className: 'ml-2' }, 'Chat')
                                ),
                                React.createElement('button', {
                                    onClick: () => setUser(null),
                                    className: 'bg-white bg-opacity-20 px-4 py-2 rounded-lg hover:bg-opacity-30 transition'
                                }, 'Salir')
                            )
                        )
                    )
                ),

                // Chat
                showChat && React.createElement('div', { className: 'max-w-5xl mx-auto px-4 py-6' },
                    React.createElement('div', { className: 'bg-white rounded-lg shadow-lg overflow-hidden', style: { height: '70vh' } },
                        React.createElement('div', { 
                            className: 'text-white p-4',
                            style: { backgroundColor: '#17355B' }
                        },
                            React.createElement('h2', { className: 'text-xl font-bold mb-3' }, 'Chat Interno'),
                            React.createElement('div', { className: 'flex space-x-2 overflow-x-auto' },
                                getAvailableGroups().map(group =>
                                    React.createElement('button', {
                                        key: group.id,
                                        onClick: () => setSelectedGroup(group.id),
                                        className: `px-3 py-1 rounded text-sm whitespace-nowrap ${selectedGroup === group.id ? 'bg-white text-blue-600' : 'bg-white bg-opacity-20'}`
                                    }, group.name)
                                )
                            )
                        ),
                        React.createElement('div', { className: 'p-4 overflow-y-auto', style: { height: 'calc(70vh - 200px)' } },
                            getFilteredMessages().length === 0 ? 
                                React.createElement('div', { className: 'text-center text-gray-400 mt-20' },
                                    React.createElement('p', null, 'No hay mensajes en este grupo')
                                ) :
                                React.createElement('div', { className: 'space-y-4' },
                                    getFilteredMessages().map((msg, idx) =>
                                        React.createElement('div', {
                                            key: idx,
                                            className: `flex ${msg.sender === user.name ? 'justify-end' : 'justify-start'}`
                                        },
                                            React.createElement('div', {
                                                className: `max-w-md p-3 rounded-lg ${msg.sender === user.name ? 'bg-blue-500 text-white' : 'bg-gray-200'}`
                                            },
                                                msg.priority && msg.priority !== 'baja' && React.createElement('div', {
                                                    className: `text-xs px-2 py-1 rounded mb-2 ${getPriorityBadge(msg.priority)} text-white inline-block`
                                                }, msg.priority.toUpperCase()),
                                                React.createElement('div', { className: 'font-semibold text-sm mb-1' }, 
                                                    msg.sender + ' (' + msg.senderRole +')'
),
msg.text && React.createElement('div', { className: 'text-sm' }, msg.text),
msg.image && React.createElement('img', {
src: msg.image,
className: 'rounded mt-2 max-w-full cursor-pointer',
onClick: () => window.open(msg.image)
}),
React.createElement('div', { className: 'text-xs mt-1 opacity-75' }, formatTime(msg.timestamp))
)
)
)
)
),
React.createElement('div', { className: 'border-t p-4' },
React.createElement('div', { className: 'flex space-x-2 mb-3' },
['urgente', 'normal', 'baja'].map(priority =>
React.createElement('button', {
key: priority,
onClick: () => setMessagePriority(priority),
className: px-3 py-1 rounded text-xs font-semibold ${messagePriority === priority ? getPriorityBadge(priority) + ' text-white' : 'bg-gray-200'}
}, priority.toUpperCase())
)
),
selectedImage && React.createElement('div', { className: 'mb-3 relative inline-block' },
React.createElement('img', { src: selectedImage, className: 'h-20 rounded border' }),
React.createElement('button', {
onClick: () => setSelectedImage(null),
className: 'absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1'
}, React.createElement(XIcon))
),
React.createElement('div', { className: 'flex space-x-2' },
React.createElement('input', {
type: 'file',
ref: fileInputRef,
onChange: handleImageSelect,
accept: 'image/*',
className: 'hidden'
}),
React.createElement('button', {
onClick: () => fileInputRef.current?.click(),
className: 'bg-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300'
}, React.createElement(ImageIconSVG)),
React.createElement('input', {
type: 'text',
value: newMessage,
onChange: (e) => setNewMessage(e.target.value),
onKeyPress: (e) => e.key === 'Enter' && sendMessage(),
placeholder: 'Mensaje...',
className: 'flex-1 border rounded-lg px-4 py-2 focus:outline-none focus:ring-2'
}),
React.createElement('button', {
onClick: sendMessage,
className: 'text-white px-6 py-2 rounded-lg hover:opacity-90',
style: { backgroundColor: '#17355B' }
}, React.createElement(SendIcon))
)
)
)
),
                                       // Notificaciones
            showNotifications && React.createElement('div', { className: 'max-w-4xl mx-auto px-4 py-6' },
                React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-6' },
                    React.createElement('div', { className: 'flex justify-between items-center mb-6' },
                        React.createElement('h2', { className: 'text-2xl font-bold', style: { color: '#17355B' } }, 'Notificaciones'),
                        unreadNotifications > 0 && React.createElement('button', {
                            onClick: markAllAsRead,
                            className: 'text-sm text-blue-600 hover:text-blue-800'
                        }, 'Marcar todas como leÃ­das')
                    ),
                    React.createElement('div', { className: 'space-y-3' },
                        notifications.length === 0 ? 
                            React.createElement('div', { className: 'text-center text-gray-400 py-12' },
                                React.createElement('p', null, 'No hay notificaciones')
                            ) :
                            notifications.map((notif, idx) =>
                                React.createElement('div', {
                                    key: idx,
                                    className: `p-4 rounded-lg ${notif.read ? 'bg-gray-50' : 'bg-blue-50 border-l-4 border-blue-500'}`
                                },
                                    notif.type === 'message' ? 
                                        React.createElement('div', null,
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'font-semibold' }, 'Nuevo mensaje de ' + notif.sender),
                                                React.createElement('span', { className: 'text-xs text-gray-500' }, formatTime(notif.timestamp))
                                            ),
                                            React.createElement('p', { className: 'text-sm text-gray-600 mt-2' }, 
                                                notif.text + (notif.hasImage ? ' ðŸ“·' : '')
                                            )
                                        ) :
                                        React.createElement('div', null,
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'font-semibold' }, 'HabitaciÃ³n #' + notif.roomNumber),
                                                React.createElement('span', { className: 'text-xs text-gray-500' }, formatTime(notif.timestamp))
                                            ),
                                            React.createElement('p', { className: 'text-sm text-gray-600 mt-2' },
                                                notif.oldStatus + ' â†’ ' + notif.newStatus + ' por ' + notif.changedBy
                                            )
                                        )
                                )
                            )
                    )
                )
            ),

            // Dashboard y habitaciones (solo si no estÃ¡ en chat ni notificaciones)
            !showChat && !showNotifications && React.createElement(React.Fragment, null,
                user.role === 'Gerencia' && React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-6' },
                    React.createElement('div', { className: 'grid grid-cols-4 gap-4 mb-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                            React.createElement('div', { className: 'text-sm text-gray-600' }, 'Limpias'),
                            React.createElement('div', { className: 'text-2xl font-bold text-green-600' },
                                rooms.filter(r => r.status === 'Limpia').length
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                            React.createElement('div', { className: 'text-sm text-gray-600' }, 'Sucias'),
                            React.createElement('div', { className: 'text-2xl font-bold text-red-600' },
                                rooms.filter(r => r.status === 'Sucia').length
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                            React.createElement('div', { className: 'text-sm text-gray-600' }, 'En Limpieza'),
                            React.createElement('div', { className: 'text-2xl font-bold text-yellow-600' },
                                rooms.filter(r => r.status === 'En Limpieza').length
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                            React.createElement('div', { className: 'text-sm text-gray-600' }, 'Total'),
                            React.createElement('div', { className: 'text-2xl font-bold', style: { color: '#17355B' } },
                                rooms.length
                            )
                        )
                    )
                ),

                React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-6' },
                    Object.entries(roomsByFloor).map(([floor, floorRooms]) =>
                        React.createElement('div', { key: floor, className: 'mb-8' },
                            React.createElement('h2', { 
                                className: 'text-lg font-bold mb-3',
                                style: { color: '#17355B' }
                            }, floor),
                            React.createElement('div', { className: 'grid grid-cols-4 gap-3' },
                                floorRooms.map(room =>
                                    React.createElement('button', {
                                        key: room.id,
                                        onClick: () => user.canEdit && setSelectedRoom(room),
                                        disabled: !user.canEdit,
                                        className: `${getStatusColor(room.status)} text-white p-4 rounded-lg transition hover:scale-105 ${!user.canEdit && 'opacity-75 cursor-default'}`
                                    },
                                        React.createElement('div', { className: 'text-center' },
                                            React.createElement('div', { className: 'text-3xl font-bold mb-1' }, '#' + room.number),
                                            React.createElement('div', { className: 'text-xs opacity-90 mb-1' }, room.category),
                                            React.createElement('div', { className: 'text-xs font-semibold mt-2 border-t border-white border-opacity-30 pt-2' }, room.status)
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            ),

            // Modal de cambio de estado
            selectedRoom && React.createElement('div', { 
                className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50',
                onClick: () => setSelectedRoom(null)
            },
                React.createElement('div', { 
                    className: 'bg-white rounded-2xl shadow-2xl max-w-md w-full',
                    onClick: (e) => e.stopPropagation()
                },
                    React.createElement('div', { 
                        className: `${getStatusColor(selectedRoom.status)} text-white p-6 rounded-t-2xl`
                    },
                        React.createElement('h3', { className: 'text-2xl font-bold' }, 'HabitaciÃ³n #' + selectedRoom.number),
                        React.createElement('p', { className: 'opacity-90' }, selectedRoom.category)
                    ),
                    React.createElement('div', { className: 'p-6' },
                        React.createElement('p', { className: 'text-gray-700 mb-4 font-semibold' }, 'Cambiar estado a:'),
                        React.createElement('div', { className: 'space-y-2' },
                            statusOptions.map(status => {
                                const isAllowed = canChangeToStatus(status.value);
                                const isCurrent = status.value === selectedRoom.status;
                                
                                return React.createElement('button', {
                                    key: status.value,
                                    onClick: () => isAllowed && handleStatusChange(selectedRoom.id, status.value),
                                    disabled: !isAllowed,
                                    className: `w-full p-3 rounded-lg font-semibold transition ${
                                        isCurrent ? status.color + ' text-white' : 
                                        isAllowed ? 'bg-gray-100 hover:bg-gray-200' : 
                                        'bg-gray-100 opacity-50 cursor-not-allowed'
                                    }`
                                }, status.value + (!isAllowed ? ' ðŸ”’' : ''));
                            })
                        ),
                        React.createElement('button', {
                            onClick: () => setSelectedRoom(null),
                            className: 'w-full mt-4 bg-gray-200 text-gray-700 p-3 rounded-lg font-semibold hover:bg-gray-300'
                        }, 'Cancelar')
                    )
                )
            ),

            React.createElement('div', { className: 'fixed bottom-4 right-4 bg-white rounded-lg shadow-lg p-3 text-xs' },
                db ? 'ðŸŸ¢ Conectado' : 'ðŸ”´ Offline'
            )
        );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(AzurHotelApp));
</script></body>
</html>
